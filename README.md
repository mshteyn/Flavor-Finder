# FLAVOR FINDER

# Flavor Finder: A Restaurant-Based Dish Recomendation System
<img width="610" alt="image" src="https://github.com/mshteyn/Flavor-Finder/assets/5659756/ab668f9f-e619-4e77-a6a0-8f939bce1012">


Flavor Finder provides query-specific menu item recommendations from local restaurants. Flavor Finder's recommendations are driven by curated summaries of user-submitted Google reviews.

## Introduction

Determing what to order in an unfamiliar restaurant is a challenge. Reviews can be a good guide. However, restaurant reviews are effortful to summarize and difficult to search through when user needs are specific. A recommendation system can help.

Recommendation systems enhance user satisfaction and facilitate exploration. Flavor Finder is a recommendation system that leverages Retrieval-Augmented 
Generation (RAG), based on a comprehensive database of Google user reviews, to deliver tailored restaurant-specific suggestions. For instance, this system can provide specific advice such as recommending a spicy yet gluten-free dish at Taj Mahal Indian Restaurant based on user-specific preferences, or a vegetarian appetizer at Noodlehead.


## Stakeholders

Flavor Finder's primary stakeholders are dining customers seeking specific 
dishes from restaurants that cater to their unique preferences and dietary requirements. 
Leveraging user reviews allows the system to provide personalized recommendations, 
enhancing the dining experience by suggesting dishes that align with individual tastes 
and restrictions. By utilizing the collective insights from numerous reviews of experienced eaters, the system can offer 
reliable recommendations, benefiting users by saving time, 
reducing decision fatigue, and increasing satisfaction with their dining choices.

Flavor Finder benefits businesses by streamlining time-costly service worker responsibilities. Flavor Finder's automated recommendation system enables service workers to redistribute effort and resources toward competing demands in high stress and fast-paced restaurant environments.


## Data Collection 
Restaurant reviews were retreived from Google Local and aggregated by Tianyang Zhang and Jiacheng Li at the University of California, San Diego for use in the following publication:

Personalized Showcases: Generating Multi-Modal Explanations for Recommendations
An Yan, Zhankui He, Jiacheng Li, Tianyang Zhang, Julian Mcauley
The 46th International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR), 2023

These data are made public at https://datarepo.eng.ucsd.edu/mcauley_group/gdrive/googlelocal/.

### Data Cleaning and Preprocessing

Reviews were filtered based on high ratings, considering only reviews rated at 3 stars out of 5 or better. Reviews fewer than 200 characters in length were removed. 

### Focus on Food-Related Mentions

To increase the signal-to-noise ratio, reviews that specifically mention food items were 
selected. A Named Entity Recognition (NER) model (InstaFoodRoBERTa-NER) was used to 
identify and filter reviews containing specific mention of food items. 


## Exploratory Data Analysis
![image](https://github.com/mshteyn/Flavor-Finder/assets/5659756/85a10095-470f-48dd-be71-b8ff7022d907)

<img width="417" alt="image" src="https://github.com/mshteyn/Flavor-Finder/assets/5659756/1f94619f-a02e-4a08-a662-10c69de33312">


## Modeling Approach

Text reviews were embedded as 1024 dimensional vectors using Alibaba's sentence transformer model (GTE-Large v1.5) and stored in a Pinecone vector database. User queries were embedded in the same way and compared to stored embeddings with cosine similarity. The top 5 closest reviews to the user query were retreived from the database and provided the context with which Llama 2 (13B Instruction-tuned) was prompted before generating a response to the user query.

## Model Evaluation

![Uploading image.pngâ€¦]()


<img width="800" alt="image" src="https://github.com/mshteyn/Flavor-Finder/blob/main/evals/Evaluation.png?raw=true">

We evaluated 20 local restaurants representing a variety of cuisines, including Italian, Maxican, Chinese, and more. each with >100 reviews. For each restaurant, customized questions were posed to assess dish recommendations. Example questions include:
- "If I want the best sandwich, what should I get at Central Diner & Grille?"
- "I don't like mushrooms, what dish do you recommend at Vedge?"

Three reviewers manually graded responses generated by three models: (1) standard pre-trained Llama 2; (2) Flavor-Finder; (3) GPT-4. Scores range from 0 to 4, based on whether the recommended dish is a real menu item from the specific restaurant and whether the recommendation was relevant to the user's question. 

Flavor-Finder achieved an average score of 3.1 out of 4, outperforming the original Llama 2 model, which scored 2.6 out of 4. 


## Challenges

Significant GPU resources are required to load the necessary components of the model.

Updating our vector database requires use of subscription based Google API keys which was beyond our budget. We've developed a tool that enables live scrapping of the Google Local API to perform this update but it is beyond the financial scope to subsidize that functionality at this time.

## Conclusion



## Future Directions



## Repository Description





